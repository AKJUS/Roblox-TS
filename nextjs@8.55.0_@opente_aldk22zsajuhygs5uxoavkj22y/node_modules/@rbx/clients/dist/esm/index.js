import{c as e,_ as t,a as n,b as r}from"./tslib.es6-7f4abb76.js";var i,o="x-csrf-token",a=o,s=function(){function t(){var e;try{if("undefined"!=typeof window)return void(this.currentToken=null!==(e=localStorage.getItem(a))&&void 0!==e?e:"")}catch(e){console.warn("Error reading localStorage key “".concat(a,"”:"),e)}this.currentToken=""}return t.prototype.storeCRSFToken=function(e){this.currentToken=e;try{"undefined"!=typeof window&&localStorage.setItem(a,e)}catch(e){console.warn("Error setting localStorage key “".concat(a,"”:"),e)}},t.prototype.pre=function(e){var t=e.url,n=e.init,r=this.currentToken;return n.headers&&"object"==typeof n.headers&&o in n.headers&&(r=n.headers[o])&&this.storeCRSFToken(r),"POST"===n.method||"PATCH"===n.method||"DELETE"===n.method||"PUT"===n.method?Promise.resolve({url:t,init:this.prepareRequestInit(n)}):Promise.resolve({url:t,init:n})},t.prototype.post=function(e){var t=e.fetch,n=e.url,r=e.init,i=e.response,a=i.headers.get(o);return 403===i.status&&i.headers.has(o)&&null!==a?(this.storeCRSFToken(a),t(n,this.prepareRequestInit(r))):Promise.resolve(i)},t.prototype.prepareRequestInit=function(t){var n;return e(e({},t),{headers:e(e({},t.headers),(n={},n[o]=this.currentToken,n))})},t}(),c="rblx-challenge-id",u="rblx-challenge-type",l="rblx-challenge-metadata";!function(e){e.UNKNOWN="unknown",e.INVALIDATED="invalidated",e.ABANDONED="abandoned",e.LOADFAILED="loadfailed"}(i||(i={}));var d=function(e){function n(t){var n=e.call(this,"challenge error for challenge kind ".concat(t.kind))||this;return n.parameters=t,n}return t(n,e),n.prototype.match=function(e){return this.parameters.kind===e.parameters.kind&&JSON.stringify(this.parameters.data)===JSON.stringify(e.parameters.data)},n.prototype.matchAbandoned=function(e){return this.match(e)&&e.parameters.kind===i.ABANDONED},n}(Error),h=function(){function t(e,t){void 0===t&&(t="iframe"),this.robloxSiteDomain=e,this.genericChallengeMiddlewareType=t,this.challengeLifecycleListener=null}return t.prototype.getTargetSubdomain=function(){return window.location.hostname.split(".").slice(0,-2).join(".")},t.prototype.constructHybridChallengeFrameURL=function(e){var t,n,r,i,o=new URLSearchParams([["challenge-type","generic"],["dark-mode","true"],["barista-mode","true"],["generic-challenge-type",null!==(t=e.headers.get(u))&&void 0!==t?t:""],["generic-challenge-id",null!==(n=e.headers.get(c))&&void 0!==n?n:""],["challenge-metadata-json",null!==(r=e.headers.get(l))&&void 0!==r?r:""],["origin",null!==(i=this.getTargetSubdomain())&&void 0!==i?i:""]]);return new URL("https://www.".concat(this.robloxSiteDomain,"/challenge/cdn/hybrid?").concat(o.toString()))},t.prototype.removeChallengeLifecycleListener=function(){this.challengeLifecycleListener&&window.removeEventListener("message",this.challengeLifecycleListener,!1)},t.prototype.createChallengeLifecycleListener=function(t,n,r,o){var a=this;return function(s){var h,f,p,m,g,v;if(s.data&&s.data.genericChallengeResponse){var y=n.fetch,b=n.url,w=n.init,L=n.response;switch(s.data.genericChallengeResponse.type){case"challengeAbandoned":a.removeChallengeLifecycleListener(),t.remove(),o(new d({kind:i.ABANDONED,data:{challengeType:null!==(h=L.headers.get(u))&&void 0!==h?h:""}}));break;case"challengeDisplayed":break;case"challengeCompleted":a.removeChallengeLifecycleListener(),t.remove(),(T=s.data.genericChallengeResponse.data).challengeType&&T.metadata?r(y(b,function(t,n,r){var i,o,a;return e(e({},t),{headers:e(e({},t.headers),(i={},i[c]=null!==(o=n.headers.get(c))&&void 0!==o?o:"",i[l]=btoa(JSON.stringify(r)),i[u]=null!==(a=n.headers.get(u))&&void 0!==a?a:"",i))})}(w,L,T.metadata))):o(new d({kind:i.UNKNOWN,data:{challengeType:null!==(f=L.headers.get(u))&&void 0!==f?f:""}}));break;case"challengeInvalidated":a.removeChallengeLifecycleListener(),t.remove(),(T=s.data.genericChallengeResponse.data)&&T.challengeType&&T.metadata?o(new d({kind:i.INVALIDATED,data:T})):o(new d({kind:i.INVALIDATED,data:{challengeType:null!==(p=L.headers.get(u))&&void 0!==p?p:""}}));break;case"challengeParsed":!1===(T=s.data.genericChallengeResponse.data).parsed&&(a.removeChallengeLifecycleListener(),t.remove(),o(new d({kind:i.UNKNOWN,data:{challengeType:null!==(m=L.headers.get(u))&&void 0!==m?m:""}})));break;case"challengeInitialized":!1===(T=s.data.genericChallengeResponse.data).initialized&&(a.removeChallengeLifecycleListener(),t.remove(),o(new d({kind:i.UNKNOWN,data:{challengeType:null!==(g=L.headers.get(u))&&void 0!==g?g:""}})));break;case"challengePageLoaded":var T;!1===(T=s.data.genericChallengeResponse.data).pageLoaded&&(a.removeChallengeLifecycleListener(),t.remove(),o(new d({kind:i.LOADFAILED,data:{challengeType:null!==(v=L.headers.get(u))&&void 0!==v?v:""}})))}}}},t.prototype.startChallengeLifecycleListener=function(e,t,n,r){window&&e&&(this.challengeLifecycleListener=this.createChallengeLifecycleListener(e,t,n,r),window.addEventListener("message",this.challengeLifecycleListener,!1))},t.prototype.post=function(e){var t=this,n=e.response;return 403===n.status&&n.headers.has(c)&&n.headers.has(u)&&n.headers.has(l)&&"iframe"===this.genericChallengeMiddlewareType?new Promise((function(r,i){var o,a;t.startChallengeLifecycleListener(function(e){return document&&document.body?document.body.appendChild(e):null}((o=t.constructHybridChallengeFrameURL(n),(a=document.createElement("iframe")).id="challenge-frame",a.allowFullscreen=!0,a.setAttribute("allowtransparency","true"),a.setAttribute("allow","publickey-credentials-get;publickey-credentials-create"),a.style.cssText="position: fixed; top: 0; left: 0; width: 100%; height: 100%; visibility: hidden; color-scheme: normal; border: none; z-index: 2147483647;",a.src=o.toString(),a.onload=function(){a.style.visibility="visible"},a)),e,r,i)})):Promise.resolve(n)},t}(),f=function(){var e=window.location.hostname.split(".").slice(0,-2).join(".");return e.includes("create")?"creator_hub":e.includes("advertise")?"ads_manager":"creator_hub"},p=function(e,t){var n="https://apis.".concat(e,"/account-security-service/v1/metrics/record");try{fetch(n,{method:"POST",body:JSON.stringify({name:"load_time_hba_frame",value:t,labelValues:{origin_site:f()}})})}catch(e){}},m=function(e,t){var n="https://apis.".concat(e,"/account-security-service/v1/metrics/record");try{fetch(n,{method:"POST",body:JSON.stringify({name:"response_time_hba_frame",value:t,labelValues:{origin_site:f()}})})}catch(e){}},g=function(e,t,n){return void 0===n&&(n=y),new Promise((function(r,i){var o,a=performance.now(),s=window.setTimeout((function(){p(e,performance.now()-a),function(e){var t="https://apis.".concat(e,"/account-security-service/v1/metrics/record");try{fetch(t,{method:"POST",body:JSON.stringify({name:"event_hba_frame",value:1,labelValues:{event_type:"FrameLoadTimedOut",origin_site:f()}})})}catch(e){}}(e),i(new Error("Promise timed out after ".concat(n," ms")))}),n),c=function(e,t,n,r,i){var o=function(t){var a=t.data;t.origin==="https://www.".concat(n)&&"dataFromHbaFrame"===a.msg&&"loaded"===a.data.type&&(window.removeEventListener("message",o,!1),window.clearTimeout(r),p(n,performance.now()-i),e())};return o}(r,0,e,s,a);window.addEventListener("message",c,!1),null===(o=t.contentWindow)||void 0===o||o.postMessage({msg:"checkLoadedRequest"},"https://www.".concat(e))}))},v=function(t,n,r,i,o,a,s){var c;if(void 0===s&&(s=b),window){var u=performance.now(),l=window.setTimeout((function(){m(r,performance.now()-u),function(e){var t="https://apis.".concat(e,"/account-security-service/v1/metrics/record");try{fetch(t,{method:"POST",body:JSON.stringify({name:"event_hba_frame",value:1,labelValues:{event_type:"FrameResponseTimedOut",origin_site:f()}})})}catch(e){}}(r),t({url:o.url,init:o.init})}),s),d=function(t,n,r,i,o,a,s){var c=function(n){var u=n.data,l=i.url,d=i.init;if(n.origin==="https://www.".concat(r)&&"dataFromHbaFrame"===u.msg&&"batHeader"===u.data.type&&(!u.data.identifier||u.data.identifier===o))if(!u.data.isError&&u.data.batHeader){window.clearTimeout(a),window.removeEventListener("message",c,!1),m(r,performance.now()-s);var h=u.data.batHeader;t({url:l,init:e(e({},d),{headers:e(e({},d.headers),{"x-bound-auth-token":h["x-bound-auth-token"]})})})}else window.clearTimeout(a),window.removeEventListener("message",c,!1),m(r,performance.now()-s),t({url:l,init:d})};return c}(t,0,r,o,a,l,u);window.addEventListener("message",d,!1),null===(c=i.contentWindow)||void 0===c||c.postMessage({msg:"signSubdomainRequest",identifier:a,serializedSubdomainRequestData:JSON.stringify({url:o.url,requestInit:o.init})},"https://www.".concat(r))}},y=1500,b=100,w=function(){function e(e,t,n){void 0===t&&(t=y),void 0===n&&(n=b);var r=this;this.getOrCreateHbaFrame=function(){if(document){var e=document.getElementById("hba-frame");return null===e&&(e=function(e){return(null===document||void 0===document?void 0:document.body)?document.body.appendChild(e):null}(function(e){var t=document.createElement("iframe");return t.id="hba-frame",t.style.cssText="position: fixed; top: 0; left: 0; width: 0%; height: 0%;",t.src="https://www.".concat(e,"/hba/iframe"),t}(r.robloxSiteDomain))),e}return null},this.robloxSiteDomain=e,this.hbaFrameAlreadyLoaded=!1,this.hbaFrameLoadFailed=!1,this.hbaFrame=null,this.loadTimeOut=t,this.dataTimeOut=n}return e.prototype.pre=function(e){var t=this;return new Promise((function(n,r){var i=e.url,o=e.init;if(t.hbaFrame=t.getOrCreateHbaFrame(),null!==t.hbaFrame){var a=crypto.randomUUID();t.hbaFrameAlreadyLoaded?v(n,0,t.robloxSiteDomain,t.hbaFrame,e,a,t.dataTimeOut):t.hbaFrameLoadFailed?n({url:i,init:o}):g(t.robloxSiteDomain,t.hbaFrame,t.loadTimeOut).then((function(){t.hbaFrame?(t.hbaFrameAlreadyLoaded=!0,v(n,0,t.robloxSiteDomain,t.hbaFrame,e,a,t.dataTimeOut)):n({url:i,init:o})})).catch((function(){t.hbaFrameLoadFailed=!0,n({url:i,init:o})}))}else n({url:i,init:o})}))},e}(),L=function(){function e(e){this.unifiedLogger=e}return e.prototype.post=function(e){return this.unifiedLogger.logApiVitalsEvent({eventName:"apiVitals",parameters:{elapsedTime:String(e.elapsedTime),apiUrl:e.url,statusCode:String(e.response.status)}}),Promise.resolve(e.response)},e}(),T=function(){function e(){this.observers=[]}return e.prototype.subscribe=function(e){var t=this;return this.observers.push(e),function(){return t.unsubscribe(e)}},e.prototype.unsubscribe=function(e){this.observers=this.observers.filter((function(t){return t!==e}))},e.prototype.post=function(e){var t=e.url,n=e.response;return 503===n.status&&this.observers.forEach((function(e){return e(t)})),Promise.resolve(n)},e}(),S=function(){function e(){}return e.prototype.parseUrl=function(e){return e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/\d+/,"/number")},e.prototype.post=function(e){var t=this;return import("@sentry/nextjs").then((function(n){var r,i=n.captureException;return!1===e.response.ok&&!1===[401,403,404].includes(e.response.status)&&i(new Error("Network error"),{tags:{apiUrl:t.parseUrl(e.url),apiStatus:null===(r=e.response)||void 0===r?void 0:r.status,cors:!1}}),e.response}))},e.prototype.onError=function(e){var t=this;return import("@sentry/nextjs").then((function(n){var r;return(0,n.captureException)(new Error("Network error"),{tags:{apiUrl:t.parseUrl(e.url),apiStatus:null===(r=e.response)||void 0===r?void 0:r.status,cors:!0}}),e.response}))},e}(),O=function(){function e(e){void 0===e&&(e={}),this.configuration=e}return Object.defineProperty(e.prototype,"config",{set:function(e){this.configuration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"basePath",{get:function(){return this.configuration.basePath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fetchApi",{get:function(){return this.configuration.fetchApi||window.fetch.bind(window)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"middleware",{get:function(){return this.configuration.middleware||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryParamsStringify",{get:function(){return this.configuration.queryParamsStringify||N},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"username",{get:function(){return this.configuration.username},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"password",{get:function(){return this.configuration.password},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiKey",{get:function(){var e=this.configuration.apiKey;if(e)return"function"==typeof e?e:function(){return e}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accessToken",{get:function(){var e=this,t=this.configuration.accessToken;if(t)return"function"==typeof t?t:function(){return n(e,void 0,void 0,(function(){return r(this,(function(e){return[2,t]}))}))}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return this.configuration.headers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"credentials",{get:function(){return this.configuration.credentials},enumerable:!1,configurable:!0}),e}(),k=new O,E=function(){function t(t){void 0===t&&(t=k);var i=this;this.configuration=t,this.fetchApi=function(t,o){return n(i,void 0,void 0,(function(){var n,i,a,s,c,u,l,d,h,f,p,m;return r(this,(function(r){switch(r.label){case 0:n={url:t,init:o},i=0,a=this.middleware,r.label=1;case 1:return i<a.length?(m=a[i]).pre?[4,m.pre(e({fetch:this.fetchApi},n))]:[3,3]:[3,4];case 2:n=r.sent()||n,r.label=3;case 3:return i++,[3,1];case 4:s=void 0,c=performance.now(),r.label=5;case 5:return r.trys.push([5,7,,12]),[4,(this.configuration.fetchApi||fetch)(n.url,n.init)];case 6:return s=r.sent(),u=performance.now(),[3,12];case 7:l=r.sent(),u=performance.now(),d=0,h=this.middleware,r.label=8;case 8:return d<h.length?(m=h[d]).onError?[4,m.onError({fetch:this.fetchApi,url:n.url,init:n.init,error:l,response:s?s.clone():void 0})]:[3,10]:[3,11];case 9:s=r.sent()||s,r.label=10;case 10:return d++,[3,8];case 11:if(void 0===s)throw l instanceof Error?new A(l,"The request failed and the interceptors did not return an alternative response"):l;return[3,12];case 12:f=0,p=this.middleware,r.label=13;case 13:return f<p.length?(m=p[f]).post?[4,m.post({fetch:this.fetchApi,url:n.url,init:n.init,response:s.clone(),elapsedTime:u-c})]:[3,15]:[3,16];case 14:s=r.sent()||s,r.label=15;case 15:return f++,[3,13];case 16:return[2,s]}}))}))},this.middleware=t.middleware}return t.prototype.withMiddleware=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.clone();return r.middleware=(e=r.middleware).concat.apply(e,t),r},t.prototype.withPreMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.map((function(e){return{pre:e}}));return this.withMiddleware.apply(this,n)},t.prototype.withPostMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.map((function(e){return{post:e}}));return this.withMiddleware.apply(this,n)},t.prototype.isJsonMime=function(e){return!!e&&t.jsonRegex.test(e)},t.prototype.request=function(e,t){return n(this,void 0,void 0,(function(){var n,i,o,a;return r(this,(function(r){switch(r.label){case 0:return[4,this.createFetchParams(e,t)];case 1:return n=r.sent(),i=n.url,o=n.init,[4,this.fetchApi(i,o)];case 2:if((a=r.sent())&&a.status>=200&&a.status<300)return[2,a];throw new P(a,"Response from ".concat(a.url," returned an error code ").concat(a.status))}}))}))},t.prototype.createFetchParams=function(t,i){return n(this,void 0,void 0,(function(){var o,a,s,c,u,l,d,h=this;return r(this,(function(f){switch(f.label){case 0:return o=this.configuration.basePath+t.path,void 0!==t.query&&0!==Object.keys(t.query).length&&(o+="?"+this.configuration.queryParamsStringify(t.query)),a=Object.assign({},this.configuration.headers,t.headers),Object.keys(a).forEach((function(e){return void 0===a[e]?delete a[e]:{}})),s="function"==typeof i?i:function(){return n(h,void 0,void 0,(function(){return r(this,(function(e){return[2,i]}))}))},c={method:t.method,headers:a,body:t.body,credentials:this.configuration.credentials},l=[e({},c)],[4,s({init:c,context:t})];case 1:return u=e.apply(void 0,l.concat([f.sent()])),d=e(e({},u),{body:(p=u.body,"undefined"!=typeof FormData&&p instanceof FormData||u.body instanceof URLSearchParams||C(u.body)?u.body:JSON.stringify(u.body))}),[2,{url:o,init:d}]}var p}))}))},t.prototype.clone=function(){var e=new(0,this.constructor)(this.configuration);return e.middleware=this.middleware.slice(),e},t.jsonRegex=new RegExp("^(:?application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(:?;.*)?$","i"),t}();function C(e){return"undefined"!=typeof Blob&&e instanceof Blob}var P=function(e){function n(t,n){var r=e.call(this,n)||this;return r.response=t,r.name="ResponseError",r}return t(n,e),n}(Error),A=function(e){function n(t,n){var r=e.call(this,n)||this;return r.cause=t,r.name="FetchError",r}return t(n,e),n}(Error),F=function(e){function n(t,n){var r=e.call(this,n)||this;return r.field=t,r.name="RequiredError",r}return t(n,e),n}(Error),D={csv:",",ssv:" ",tsv:"\t",pipes:"|"};function R(e,t){var n=e[t];return null!=n}function N(e,t){return void 0===t&&(t=""),Object.keys(e).map((function(n){return x(n,e[n],t)})).filter((function(e){return e.length>0})).join("&")}function x(e,t,n){void 0===n&&(n="");var r=n+(n.length?"[".concat(e,"]"):e);if(t instanceof Array){var i=t.map((function(e){return encodeURIComponent(String(e))})).join("&".concat(encodeURIComponent(r),"="));return"".concat(encodeURIComponent(r),"=").concat(i)}return t instanceof Set?x(e,Array.from(t),n):t instanceof Date?"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(t.toISOString())):t instanceof Object?N(t,r):"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(String(t)))}function j(t,n){return Object.keys(t).reduce((function(r,i){var o;return e(e({},r),((o={})[i]=n(t[i]),o))}),{})}function I(e){for(var t=0,n=e;t<n.length;t++){if("multipart/form-data"===n[t].contentType)return!0}return!1}var U=function(){function e(e,t){void 0===t&&(t=function(e){return e}),this.raw=e,this.transformer=t}return e.prototype.value=function(){return n(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return e=this.transformer,[4,this.raw.json()];case 1:return[2,e.apply(this,[t.sent()])]}}))}))},e}(),_=function(){function e(e){this.raw=e}return e.prototype.value=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){return[2,void 0]}))}))},e}(),q=function(){function e(e){this.raw=e}return e.prototype.value=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.raw.blob()];case 1:return[2,e.sent()]}}))}))},e}(),M=function(){function e(e){this.raw=e}return e.prototype.value=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.raw.text()];case 1:return[2,e.sent()]}}))}))},e}(),H=new s,J=new T,V=[function(e){return!0===e.enableSentry?new S:void 0},function(e){return e.robloxSiteDomain&&e.enableBoundAuthToken?new w(e.robloxSiteDomain,e.boundAuthTokenLoadTimeout,e.boundAuthTokenDataTimeout):void 0},function(e){return e.robloxSiteDomain?new h(e.robloxSiteDomain,e.genericChallengeMiddlewareType):void 0},function(e){return e.unifiedLogger?new L(e.unifiedLogger):void 0},function(){return H},function(){return J}],B=function(n){function r(t){void 0===t&&(t={});var r=e({},t),i=r.middleware||[];return i.unshift.apply(i,V.map((function(e){return e(r)})).filter((function(e){return void 0!==e}))),r.middleware=i,n.call(this,r)||this}return t(r,n),r}(O);export{E as BaseAPI,O as BaseConfiguration,q as BlobApiResponse,D as COLLECTION_FORMATS,B as Configuration,k as DefaultConfig,A as FetchError,U as JSONApiResponse,F as RequiredError,P as ResponseError,M as TextApiResponse,_ as VoidApiResponse,I as canConsumeForm,R as exists,J as maintenanceMiddleware,j as mapValues,N as querystring};
