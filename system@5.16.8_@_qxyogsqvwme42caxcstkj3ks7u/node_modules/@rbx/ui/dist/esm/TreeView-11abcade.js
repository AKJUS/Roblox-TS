import{_ as e,a as t}from"./tslib.es6-867fbf56.js";import*as r from"react";import n,{forwardRef as a}from"react";import o from"./styles/makeStyles.js";import s from"./theme/typography.js";import l from"./utils/combineOverrides.js";import{_ as c}from"./extends-64d70faf.js";import{g as u,_ as d,p as i}from"./createTheme-1ca289da.js";import{s as f,c as p,a as m}from"./styled-0a99a76f.js";import{T as b}from"./TreeViewContext-11d6046e.js";import{D as x,t as I}from"./treeItemClasses-078aa536.js";import{g}from"./generateUtilityClasses-802dc398.js";import{jsx as y}from"react/jsx-runtime";import{u as h}from"./useThemeProps-589cc86d.js";import{u as O}from"./useTheme-2928209d.js";import{u as E}from"./useId-2f70081c.js";import{u as j}from"./useForkRef-ab32d86c.js";import{u as w}from"./useControlled-d52b6c72.js";import{o as C}from"./ownerDocument-1b00e83d.js";import{E as N}from"./ExpandMore-fdbe810f.js";import{N as T}from"./NavigateNext-6c2b415b.js";function S(e){return u("MuiTreeView",e)}var k=g("MuiTreeView",["root"]);const v=["children","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disabledItemsFocusable","disableSelection","expanded","id","multiSelect","onBlur","onFocus","onKeyDown","onNodeFocus","onNodeSelect","onNodeToggle","selected"],F=f("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:0,margin:0,listStyle:"none",outline:0});function A(e,t,r){for(let n=t;n<e.length;n+=1)if(r===e[n])return n;return-1}function K(){return!1}const R=[],D=[],P=r.forwardRef((function(e,t){const n=h({props:e,name:"MuiTreeView"}),{children:a,className:o,defaultCollapseIcon:s,defaultEndIcon:l,defaultExpanded:u=R,defaultExpandIcon:i,defaultParentIcon:f,defaultSelected:I=D,disabledItemsFocusable:g=!1,disableSelection:N=!1,expanded:T,id:k,multiSelect:P=!1,onBlur:V,onFocus:M,onKeyDown:_,onNodeFocus:B,onNodeSelect:L,onNodeToggle:U,selected:H}=n,Z=d(n,v),q="rtl"===O().direction,z=c({},n,{defaultExpanded:u,defaultSelected:I,disabledItemsFocusable:g,disableSelection:N,multiSelect:P}),G=(e=>{const{classes:t}=e;return m({root:["root"]},S,t)})(z),J=E(k),Q=r.useRef(null),W=j(Q,t),[X,Y]=r.useState(null),$=r.useRef({}),ee=r.useRef({}),[te,re]=w({controlled:T,default:u,name:"TreeView",state:"expanded"}),[ne,ae]=w({controlled:H,default:I,name:"TreeView",state:"selected"}),oe=r.useCallback((e=>!!Array.isArray(te)&&-1!==te.indexOf(e)),[te]),se=r.useCallback((e=>$.current[e]&&$.current[e].expandable),[]),le=r.useCallback((e=>Array.isArray(ne)?-1!==ne.indexOf(e):ne===e),[ne]),ce=r.useCallback((e=>{let t=$.current[e];if(!t)return!1;if(t.disabled)return!0;for(;null!=t.parentId;)if(t=$.current[t.parentId],t.disabled)return!0;return!1}),[]),ue=e=>Object.keys($.current).map((e=>$.current[e])).filter((t=>t.parentId===e)).sort(((e,t)=>e.index-t.index)).map((e=>e.id)),de=e=>{let t=ue(e);return g||(t=t.filter((e=>!ce(e)))),t},ie=e=>{if(oe(e)&&de(e).length>0)return de(e)[0];let t=$.current[e];for(;null!=t;){const e=de(t.parentId),r=e[e.indexOf(t.id)+1];if(r)return r;t=$.current[t.parentId]}return null},fe=e=>{const t=$.current[e],r=de(t.parentId),n=r.indexOf(e);if(0===n)return t.parentId;let a=r[n-1];for(;oe(a)&&de(a).length>0;)a=de(a).pop();return a},pe=()=>{let e=de(null).pop();for(;oe(e);)e=de(e).pop();return e},me=()=>de(null)[0],be=(e,t)=>{const[r,n]=((e,t)=>{if(e===t)return[e,t];const r=$.current[e],n=$.current[t];if(r.parentId===n.id||n.parentId===r.id)return n.parentId===r.id?[r.id,n.id]:[n.id,r.id];const a=[r.id],o=[n.id];let s=r.parentId,l=n.parentId,c=-1!==o.indexOf(s),u=-1!==a.indexOf(l),d=!0,i=!0;for(;!u&&!c;)d&&(a.push(s),c=-1!==o.indexOf(s),d=null!==s,!c&&d&&(s=$.current[s].parentId)),i&&!c&&(o.push(l),u=-1!==a.indexOf(l),i=null!==l,!u&&i&&(l=$.current[l].parentId));const f=c?s:l,p=ue(f),m=a[a.indexOf(f)-1],b=o[o.indexOf(f)-1];return p.indexOf(m)<p.indexOf(b)?[e,t]:[t,e]})(e,t),a=[r];let o=r;for(;o!==n;)o=ie(o),a.push(o);return a},xe=(e,t)=>{t&&(Y(t),B&&B(e,t))},Ie=(e,t)=>xe(e,ie(t)),ge=(e,t=X)=>{let r;r=-1!==te.indexOf(t)?te.filter((e=>e!==t)):[t].concat(te),U&&U(e,r),re(r)},ye=r.useRef(null),he=r.useRef(!1),Oe=r.useRef([]),Ee=(e,t,r=!1)=>!!t&&(r?((e,t)=>{let r;r=-1!==ne.indexOf(t)?ne.filter((e=>e!==t)):[t].concat(ne),L&&L(e,r),ae(r)})(e,t):((e,t)=>{const r=P?[t]:t;L&&L(e,r),ae(r)})(e,t),ye.current=t,he.current=!1,Oe.current=[],!0),je=(e,t,r=!1)=>{const{start:n=ye.current,end:a,current:o}=t;r?((e,t)=>{let r=ne.slice();const{start:n,next:a,current:o}=t;a&&o&&(-1===Oe.current.indexOf(o)&&(Oe.current=[]),he.current?-1!==Oe.current.indexOf(a)?(r=r.filter((e=>e===n||e!==o)),Oe.current=Oe.current.filter((e=>e===n||e!==o))):(r.push(a),Oe.current.push(a)):(r.push(a),Oe.current.push(o,a)),L&&L(e,r),ae(r))})(e,{start:n,next:a,current:o}):null!=n&&null!=a&&((e,t)=>{let r=ne.slice();const{start:n,end:a}=t;he.current&&(r=r.filter((e=>-1===Oe.current.indexOf(e))));let o=be(n,a);o=o.filter((e=>!ce(e))),Oe.current=o;let s=r.concat(o);s=s.filter(((e,t)=>s.indexOf(e)===t)),L&&L(e,s),ae(s)})(e,{start:n,end:a}),he.current=!0},we=r.useCallback((e=>{const{id:t,index:r,parentId:n,expandable:a,idAttribute:o,disabled:s}=e;$.current[t]={id:t,index:r,parentId:n,expandable:a,idAttribute:o,disabled:s}}),[]),Ce=r.useCallback((e=>{const t=c({},$.current);delete t[e],$.current=t,Y((t=>t===e&&Q.current===C(Q.current).activeElement?ue(null)[0]:t))}),[]),Ne=r.useCallback(((e,t)=>{ee.current[e]=t}),[]),Te=r.useCallback((e=>{const t=c({},ee.current);delete t[e],ee.current=t}),[]),Se=e=>(se(X)&&(oe(X)?Ie(e,X):ce(X)||ge(e)),!0),ke=e=>{if(oe(X)&&!ce(X))return ge(e,X),!0;const t=(r=X,$.current[r].parentId);var r;return!!t&&(xe(e,t),!0)},ve=$.current[X]?$.current[X].idAttribute:null;return y(b.Provider,{value:{icons:{defaultCollapseIcon:s,defaultExpandIcon:i,defaultParentIcon:f,defaultEndIcon:l},focus:xe,toggleExpansion:ge,isExpanded:oe,isExpandable:se,isFocused:e=>X===e,isSelected:le,isDisabled:ce,selectNode:N?K:Ee,selectRange:N?K:je,multiSelect:P,disabledItemsFocusable:g,mapFirstChar:Ne,unMapFirstChar:Te,registerNode:we,unregisterNode:Ce,treeId:J},children:y(x,{children:y(F,c({role:"tree",id:J,"aria-activedescendant":ve,"aria-multiselectable":P,className:p(G.root,o),ref:W,tabIndex:0,onKeyDown:e=>{let t=!1;const r=e.key;if(e.altKey||e.currentTarget!==e.target||!X)return;const n=e.ctrlKey||e.metaKey;switch(r){case" ":N||ce(X)||(P&&e.shiftKey?(je(e,{end:X}),t=!0):t=P?Ee(e,X,!0):Ee(e,X)),e.stopPropagation();break;case"Enter":ce(X)||(se(X)?(ge(e),t=!0):t=P?Ee(e,X,!0):Ee(e,X)),e.stopPropagation();break;case"ArrowDown":P&&e.shiftKey&&!N&&((e,t)=>{ce(ie(t))||je(e,{end:ie(t),current:t},!0)})(e,X),Ie(e,X),t=!0;break;case"ArrowUp":P&&e.shiftKey&&!N&&((e,t)=>{ce(fe(t))||je(e,{end:fe(t),current:t},!0)})(e,X),((e,t)=>{xe(e,fe(t))})(e,X),t=!0;break;case"ArrowRight":t=q?ke(e):Se(e);break;case"ArrowLeft":t=q?Se(e):ke(e);break;case"Home":P&&n&&e.shiftKey&&!N&&!ce(X)&&((e,t)=>{ye.current||(ye.current=t);const r=he.current?ye.current:t;je(e,{start:r,end:me()})})(e,X),(e=>{xe(e,me())})(e),t=!0;break;case"End":P&&n&&e.shiftKey&&!N&&!ce(X)&&((e,t)=>{ye.current||(ye.current=t);const r=he.current?ye.current:t;je(e,{start:r,end:pe()})})(e,X),(e=>{xe(e,pe())})(e),t=!0;break;default:"*"===r?(((e,t)=>{const r=$.current[t],n=ue(r.parentId).filter((e=>se(e)&&!oe(e))),a=te.concat(n);n.length>0&&(re(a),U&&U(e,a))})(e,X),t=!0):P&&n&&"a"===r.toLowerCase()&&!N?((e=>{je(e,{start:me(),end:pe()})})(e),t=!0):!n&&!e.shiftKey&&((a=r)&&1===a.length&&a.match(/\S/))&&(((e,t,r)=>{let n,a;const o=r.toLowerCase(),s=[],l=[];Object.keys(ee.current).forEach((e=>{const t=ee.current[e],r=$.current[e],n=!r.parentId||oe(r.parentId),a=!g&&ce(e);n&&!a&&(s.push(e),l.push(t))})),n=s.indexOf(t)+1,n>=s.length&&(n=0),a=A(l,n,o),-1===a&&(a=A(l,0,o)),a>-1&&xe(e,s[a])})(e,X,r),t=!0)}var a;t&&(e.preventDefault(),e.stopPropagation()),_&&_(e)},onFocus:e=>{if(e.target===e.currentTarget){const t=Array.isArray(ne)?ne[0]:ne;xe(e,t||de(null)[0])}M&&M(e)},onBlur:e=>{Y(null),V&&V(e)},ownerState:z},Z,{children:a}))})})}));"production"!==process.env.NODE_ENV&&(P.propTypes={children:i.node,classes:i.object,className:i.string,defaultCollapseIcon:i.node,defaultEndIcon:i.node,defaultExpanded:i.arrayOf(i.string),defaultExpandIcon:i.node,defaultParentIcon:i.node,defaultSelected:i.oneOfType([i.arrayOf(i.string),i.string]),disabledItemsFocusable:i.bool,disableSelection:i.bool,expanded:i.arrayOf(i.string),id:i.string,multiSelect:i.bool,onBlur:i.func,onFocus:i.func,onKeyDown:i.func,onNodeFocus:i.func,onNodeSelect:i.func,onNodeToggle:i.func,selected:i.oneOfType([i.arrayOf(i.string),i.string]),sx:i.oneOfType([i.arrayOf(i.oneOfType([i.func,i.object,i.bool])),i.func,i.object])});var V=P,M=o({name:"TreeView"})((function(t,r){var n,a,o=r.variant,l="default"===o?s.body1:s.body2;return{root:(n={},n["& .".concat(I.content)]=e(e({},t.border.radius.medium),(a={padding:"default"===o?8:"4px 8px"},a["& .".concat(I.label,", &.").concat(I.selected," .").concat(I.label)]=e({},l),a)),n)}})),_=a((function(r,a){var o=r.children,s=r.classes,c=r.defaultCollapseIcon,u=r.defaultExpandIcon,d=r.variant,i=void 0===d?"dense":d,f=r.className,p=t(r,["children","classes","defaultCollapseIcon","defaultExpandIcon","variant","className"]),m=M(e(e({},p),{variant:i}),{props:{classes:l(s,f)}});return n.createElement(V,e({},p,{classes:m.classes,defaultCollapseIcon:null!=c?c:n.createElement(N,null),defaultExpandIcon:null!=u?u:n.createElement(T,null),ref:a}),o)}));export{_ as T,k as t};
